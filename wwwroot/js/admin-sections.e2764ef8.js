(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{"02cf":function(t,e,n){"use strict";(function(t){n("ac6a"),n("ac4d"),n("8a81"),n("5df3"),n("1c4c"),n("6b54"),n("06db"),n("7f7f");var i=n("967e"),o=n.n(i),a=(n("a481"),n("96cf"),n("fa84")),s=n.n(a);n("11ec");function r(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=l(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o,a=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function l(t,e){if(t){if("string"===typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}e["a"]={name:"EditSection",mixins:[t],props:{name:{type:String,required:!0}},computed:{breadcrumbsCategory:function(){return this.$getBreadcrumbs("SectionsAdmin")}},data:function(){return{section:null,loading:!1}},methods:{save:function(){var t=this,e=this.$refs.form;if(e.validate(),!e.hasError){this.loading=!0;var n=JSON.parse(JSON.stringify(this.section));delete n.enums,n.options={};var i,a=r(this.section.options);try{for(a.s();!(i=a.n()).done;){var l=i.value;n.options[l.name]=l.value}}catch(c){a.e(c)}finally{a.f()}n.options=JSON.stringify(n.options),this.$request(this.$AdminApi.SectionsAdmin.UpdateSection,n,!0).then(s()(o.a.mark((function e(){return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$successNotify(),e.next=3,t.$store.dispatch("loadAllSections");case 3:return e.next=5,t.$store.dispatch("setAllRoutes");case 5:t.$router.replace({name:"SectionsAdmin"});case 6:case"end":return e.stop()}}),e)})))).catch((function(e){t.$errorNotify(e),t.loading=!1}))}},removeSection:function(){var t=this,e=this.$tl("deleteMsg"),n=this.$tl("btnDeleteOk"),i=this.$tl("btnDeleteCancel");this.$q.dialog({message:e,ok:n,cancel:i}).onOk((function(){return t.$request(t.$AdminApi.SectionsAdmin.DeleteSection,{sectionId:t.section.id}).then((function(){t.$successNotify(null,"warning"),t.$router.push({name:"SectionsAdmin"})})).catch((function(e){t.$errorNotify(e),t.loading=!1}))}))},loadData:function(){var t=this;this.$request(this.$AdminApi.SectionsAdmin.GetSection,{name:this.name}).then((function(e){t.section=e.data}))}},beforeCreate:function(){this.$options.components.SectionForm=n("c7eb").SectionForm},created:function(){this.title=this.$tl("title"),this.loadData()}}}).call(this,n("7c53")["default"])},"07aa":function(t,e,n){"use strict";var i=n("a206"),o=n.n(i);o.a},"5ecc":function(t,e,n){},"5f91":function(t,e,n){"use strict";var i=n("6bfa"),o=n.n(i);o.a},6644:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",["Boolean"===t.item.type?n("q-checkbox",{attrs:{dense:""},model:{value:t.item.value,callback:function(e){t.$set(t.item,"value",e)},expression:"item.value"}}):"Integer"===t.item.type?n("q-input",{ref:"input",attrs:{dense:"",type:"number",value:t.item.value},on:{input:function(e){t.item.value=parseInt(e)}}}):"String"===t.item.type?n("q-input",{ref:"input",attrs:{dense:"",clearable:"",type:"text"},model:{value:t.item.value,callback:function(e){t.$set(t.item,"value",e)},expression:"item.value"}}):"LongString"===t.item.type?n("q-input",{ref:"input",attrs:{dense:"",clearable:"",type:"textarea"},model:{value:t.item.value,callback:function(e){t.$set(t.item,"value",e)},expression:"item.value"}}):t.enums&&"Enum"===t.item.type?n("q-select",{attrs:{dense:"",options:t.enums[t.item.enum]},model:{value:t.item.value,callback:function(e){t.$set(t.item,"value",e)},expression:"item.value"}}):"Tokens"===t.item.type?n("q-select",{attrs:{dense:"",value:t.item.value.split(",").filter((function(t){return t})),"hide-dropdown-icon":"","input-debounce":"0","new-value-mode":"add-unique","use-input":"",multiple:"","use-chips":""},on:{input:function(e){t.item.value=e.join(",")}}}):"Html"===t.item.type?n("SunEditor",{ref:"input",attrs:{height:"5rem","min-height":"3rem"},model:{value:t.item.value,callback:function(e){t.$set(t.item,"value",e)},expression:"item.value"}}):"Json"===t.item.type?n("q-input",{ref:"input",staticClass:"jj",staticStyle:{position:"relative"},attrs:{"input-style":"height:7rem",dense:"",type:"textarea","hide-hint":"","hide-bottom-space":"",rules:t.jsonRules},model:{value:t.item.value,callback:function(e){t.$set(t.item,"value",e)},expression:"item.value"}},[n("q-btn",{staticClass:"config-item__pretty-btn",staticStyle:{position:"absolute",top:"5px",right:"24px",display:"none"},attrs:{round:"",dense:"",size:"12px",icon:t.$iconsSet.ConfigItem.pretty},on:{click:t.prepareJson}},[n("q-tooltip",[t._v(t._s(t.$tl("pretty")))])],1)],1):"Roles"===t.item.type?n("q-select",{attrs:{dense:"",options:t.allRoles,multiple:"","use-chips":"","stack-label":"","option-value":"name","option-label":"title"},on:{loadstart:t.prepareRoles},model:{value:t.roles,callback:function(e){t.roles=e},expression:"roles"}}):"Categories"===t.item.type?n("CategoriesInput",{attrs:{categoriesNames:"Root",multiple:"",showRoot:""},model:{value:t.item.value,callback:function(e){t.$set(t.item,"value",e)},expression:"item.value"}}):n("q-input",{ref:"input",attrs:{clearable:"",dense:"",type:"text"},model:{value:t.item.value,callback:function(e){t.$set(t.item,"value",e)},expression:"item.value"}})],1)},o=[],a=(n("28a5"),n("7f7f"),n("6fb1")),s={name:"ConfigItem",props:{item:{type:Object,required:!0},enums:{type:Object,required:!1},allRoles:{type:Array,required:!0}},data:function(){return{roles:[]}},watch:{roles:"rolesUpdated"},computed:{jsonRules:function(){return Object(a["jsonRules"])()},hasError:function(){var t,e;null===(t=this.$refs)||void 0===t||null===(e=t.input)||void 0===e||e.hasError}},methods:{rolesUpdated:function(){var t,e,n,i;this.item.value=null!==(t=null===(e=this.roles)||void 0===e||null===(n=e.map((function(t){return t.name})))||void 0===n||null===(i=n.filter((function(t){return t})))||void 0===i?void 0:i.join(","))&&void 0!==t?t:""},prepareRoles:function(){var t,e,n=null!==(t=null===(e=this.item.value)||void 0===e?void 0:e.split(","))&&void 0!==t?t:[];this.roles=this.allRoles.filter((function(t){return n.some((function(e){return e===t.name}))}))},prepareJson:function(){this.item.value=JSON.stringify(JSON.parse(this.item.value),null,4)},validate:function(){var t,e;null===(t=this.$refs)||void 0===t||null===(e=t.input)||void 0===e||e.validate()}},beforeCreate:function(){this.$options.components.CategoriesInput=n("a996").CategoriesInput},created:function(){switch(this.item.type){case"Roles":this.prepareRoles();break}}},r=s,l=(n("5f91"),n("2877")),c=n("eebe"),u=n.n(c),m=n("8f8e"),d=n("27f9"),f=n("ddd8"),p=n("9c40"),h=n("05c0"),v=n("8572"),b=Object(l["a"])(r,i,o,!1,null,null,null);e["a"]=b.exports;u()(b,"components",{QCheckbox:m["a"],QInput:d["a"],QSelect:f["a"],QBtn:p["a"],QTooltip:h["a"],QField:v["a"]})},"6bfa":function(t,e,n){},"9d98":function(t,e,n){"use strict";var i=n("5ecc"),o=n.n(i);o.a},a206:function(t,e,n){},a2ec:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"section-form q-gutter-sm"},[t.section.options&&t.section.options.length>0&&t.allRoles?n("q-markup-table",{attrs:{flat:"",bordered:"","wrap-cells":""}},[n("tr",[n("td",{staticClass:"config-item__name-column"},[t._v(t._s(t.$tl("type")))]),n("td",[t._v("\n\t\t\t\t"+t._s(t.$t("SectionsEditor."+t.section.type+".name"))+"\n\t\t\t")])]),n("tr",[n("td",{staticClass:"config-item__name-column"},[t._v(t._s(t.$tl("name")))]),n("td",[n("q-input",{ref:"name",staticClass:"section-form__name",attrs:{dense:"","hide-bottom-space":"","hide-hint":"",rules:t.rules.name},model:{value:t.section.name,callback:function(e){t.$set(t.section,"name",e)},expression:"section.name"}})],1)]),n("tr",[n("td",{staticClass:"config-item__name-column"},[t._v(t._s(t.$tl("token")))]),n("td",[n("q-input",{ref:"token",staticClass:"section-form__name",attrs:{dense:"","hide-bottom-space":"","hide-hint":"",rules:t.rules.token},model:{value:t.section.token,callback:function(e){t.$set(t.section,"token",e)},expression:"section.token"}})],1)]),n("tr",[n("td",{staticClass:"config-item__name-column"},[t._v(t._s(t.$tl("roles")))]),n("td",[t.allRoles?n("q-select",{staticClass:"section-form__title",attrs:{dense:"",options:t.allRoles,multiple:"","use-chips":"","stack-label":"","option-value":"name","option-label":"title"},model:{value:t.roles,callback:function(e){t.roles=e},expression:"roles"}}):n("LoaderWait")],1)]),n("tr",[n("td",{staticClass:"config-item__name-column"},[t._v(t._s(t.$tl("isCacheData")))]),n("td",[n("q-checkbox",{ref:"isCacheData",staticClass:"section-form__is-cache-data",attrs:{dense:""},model:{value:t.section.isCacheData,callback:function(e){t.$set(t.section,"isCacheData",e)},expression:"section.isCacheData"}})],1)]),t._l(t.section.options,(function(e){return n("tr",{key:e.name},[n("td",[t._v(t._s(t.$t("SectionsEditor."+t.section.type+"."+e.name)))]),n("td",[n("ConfigItem",{ref:"configItem",refInFor:!0,attrs:{allRoles:t.allRoles,item:e,enums:t.section.enums}})],1)])}))],2):t._e()],1)},o=[];n("28a5"),n("7f7f");function a(){var t=this;return{name:[function(e){return!!e||t.$tl("validation.name.required")},function(e){return!e||e.length>=3||t.$tl("validation.name.minLength")},function(e){return!e||e.length<=config.DbColumnSizes.MenuItems_Name||t.$tl("validation.name.maxLength")},function(e){return/^[a-zA-Z0-9_-]*$/.test(e)||t.$tl("validation.name.allowedChars")}],token:[function(e){return!e||e.length<=config.DbColumnSizes.Sections_Token||t.$tl("validation.token.maxLength")},function(e){return/^[a-zA-Z0-9-]*$/.test(e)||t.$tl("validation.token.allowedChars")}],type:[function(e){return!!e||t.$tl("validation.type.required")}]}}var s={name:"SectionForm",props:{section:{type:Object,required:!0},editMode:{type:Boolean,required:!1,default:!1}},data:function(){return{allRoles:null,roles:null}},watch:{roles:"rolesUpdated","section.type":"typeChanges"},computed:{hasError:function(){return this.$refs.name.hasError||this.$refs["configItem"].some((function(t){return t.hasError}))}},methods:{rolesUpdated:function(){this.section.roles=this.roles.map((function(t){return t.name})).join(",")},validate:function(){this.$refs.name.validate(),this.$refs["configItem"].forEach((function(t){return t.validate()}))},loadRoles:function(){var t=this;this.$request(this.$AdminApi.UserRolesAdmin.GetAllRoles).then((function(e){t.allRoles=e.data,t.allRoles.push({name:"Unregistered",title:"Unregistered"});var n=t.section.roles.split(",");t.roles=t.allRoles.filter((function(t){return n.some((function(e){return e===t.name}))}))}))}},beforeCreate:function(){this.$options.components.ConfigItem=n("c7eb").ConfigItem},created:function(){this.rules=a.call(this),this.loadRoles()}},r=s,l=(n("9d98"),n("2877")),c=n("eebe"),u=n.n(c),m=n("2bb1"),d=n("27f9"),f=n("ddd8"),p=n("8f8e"),h=Object(l["a"])(r,i,o,!1,null,null,null);e["a"]=h.exports;u()(h,"components",{QMarkupTable:m["a"],QInput:d["a"],QSelect:f["a"],QCheckbox:p["a"]})},d2f2:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("SunPage",{staticClass:"create-section page-padding"},[n("PageHeader",{attrs:{title:t.title}}),t.section?n("SectionForm",{ref:"form",staticClass:"q-mb-xl",attrs:{editMode:!1,section:t.section}}):t._e(),n("div",{staticClass:"create-section__btn-block q-mt-lg q-gutter-md"},[n("q-btn",{staticClass:"send-btn",attrs:{icon:t.$iconsSet.CreateSection.add,"no-caps":"",loading:t.loading,label:t.$tl("createBtn"),color:"send"},on:{click:t.save}},[n("LoaderSent",{attrs:{slot:"loading"},slot:"loading"})],1),n("q-btn",{staticClass:"cancel-btn",attrs:{"no-caps":"",icon:t.$iconsSet.CreateSection.cancel,label:t.$tl("cancelBtn"),color:"warning"},on:{click:function(e){return t.$router.back()}}})],1)],1)},o=[],a=n("f99f"),s=a["a"],r=n("2877"),l=n("eebe"),c=n.n(l),u=n("9c40"),m=Object(r["a"])(s,i,o,!1,null,"574d9211",null);e["a"]=m.exports;c()(m,"components",{QBtn:u["a"]})},ed28:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("SunPage",{staticClass:"edit-section page-padding"},[n("PageHeader",{attrs:{title:t.title}}),t.section?n("SectionForm",{ref:"form",staticClass:"q-mb-xl",attrs:{editMode:!0,section:t.section}}):n("LoaderWait"),n("div",{staticClass:"q-gutter-md"},[n("q-btn",{staticClass:"send-btn",attrs:{icon:t.$iconsSet.EditSection.save,"no-caps":"",loading:t.loading,label:t.$tl("saveBtn"),color:"send"},on:{click:t.save}},[n("LoaderSent",{attrs:{slot:"loading"},slot:"loading"})],1),n("q-btn",{staticClass:"cancel-btn q-ml-sm",attrs:{"no-caps":"",icon:t.$iconsSet.EditSection.cancel,label:t.$tl("cancelBtn"),color:"warning"},on:{click:function(e){return t.$router.back()}}}),n("q-btn",{staticClass:"delete-btn q-ml-sm float-right",attrs:{"no-caps":"",icon:t.$iconsSet.EditSection.delete,label:t.$tl("deleteBtn")},on:{click:function(e){return t.removeSection()}}})],1)],1)},o=[],a=n("02cf"),s=a["a"],r=n("2877"),l=n("eebe"),c=n.n(l),u=n("9c40"),m=Object(r["a"])(s,i,o,!1,null,"6619f3fa",null);e["a"]=m.exports;c()(m,"components",{QBtn:u["a"]})},efd5:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("SunPage",{staticClass:"sections-admin page-padding"},[n("PageHeader",{attrs:{title:t.$tl("title")}},[n("q-btn-dropdown",{staticClass:"post-btn q-mr-lg",attrs:{icon:t.$iconsSet.SectionsAdmin.add,type:"a",label:t.$tl("addSectionBtn")}},[n("q-list",t._l(t.templatesNames,(function(e){return n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:e,attrs:{"no-caps":"",to:{name:"CreateSection",params:{templateName:e}}}},[n("q-item-section",[n("q-item-label",[t._v(t._s(t.$t("SectionsEditor."+e+".name")))])],1)],1)})),1)],1)],1),t.sections?n("div",{staticClass:"sections-admin__sections"},t._l(t.sections,(function(e){return n("div",[n("q-icon",{staticClass:"q-mr-sm",attrs:{name:t.$iconsSet.SectionsAdmin.section,color:"grey-6"}}),t._v("\n\t\t\t"+t._s(e.name)+"\n\t\t\t"),n("q-btn",{staticClass:"sections-admin__btn-edit q-ml-sm",attrs:{color:"info",dense:"",size:"10px",flat:"",icon:t.$iconsSet.SectionsAdmin.edit,to:{name:"EditSection",params:{name:e.name}}}}),n("q-btn",{staticClass:"sections-admin__to",attrs:{color:"info",dense:"",size:"10px",flat:"",icon:t.$iconsSet.SectionsAdmin.goTo,to:"/"+e.name.toLowerCase()}}),n("span",{staticClass:"q-ml-lg text-grey-7"},[t._v("["+t._s(e.type)+"]")])],1)})),0):n("LoaderWait")],1)},o=[],a=(n("7f7f"),n("ac6a"),n("cadf"),n("06db"),n("8615"),n("e856")),s={name:"SectionsAdmin",mixins:[a["Page"]],data:function(){return{sections:null}},computed:{breadcrumbsCategory:function(){return this.$getBreadcrumbs("Admin")},templatesNames:function(){var t=Object.values(this.$store.state.sections.sectionsTypes).map((function(t){return t.name}));return t}},methods:{loadData:function(){var t=this;this.$request(this.$AdminApi.SectionsAdmin.GetAllSections).then((function(e){t.sections=e.data}))}},created:function(){this.title=this.$tl("title"),this.loadData()}},r=s,l=(n("07aa"),n("2877")),c=n("eebe"),u=n.n(c),m=n("f20b"),d=n("1c1c"),f=n("66e5"),p=n("4074"),h=n("0170"),v=n("0016"),b=n("9c40"),g=n("7f67"),$=Object(l["a"])(r,i,o,!1,null,null,null);e["a"]=$.exports;u()($,"components",{QBtnDropdown:m["a"],QList:d["a"],QItem:f["a"],QItemSection:p["a"],QItemLabel:h["a"],QIcon:v["a"],QBtn:b["a"]}),u()($,"directives",{ClosePopup:g["a"]})},f99f:function(t,e,n){"use strict";(function(t){n("ac6a"),n("ac4d"),n("8a81"),n("5df3"),n("1c4c"),n("6b54"),n("06db"),n("7f7f");var i=n("967e"),o=n.n(i),a=(n("a481"),n("96cf"),n("fa84")),s=n.n(a);function r(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=l(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o,a=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function l(t,e){if(t){if("string"===typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}e["a"]={name:"CreateSection",mixins:[t],props:{templateName:{type:String,required:!0}},data:function(){return{section:null,loading:!1}},computed:{breadcrumbsCategory:function(){return this.$getBreadcrumbs("SectionsAdmin")}},methods:{getSectionTemplate:function(){var t=this;this.$request(this.$AdminApi.SectionsAdmin.GetSectionTemplate,{templateName:this.templateName}).then((function(e){t.section=e.data}))},save:function(){var t=this,e=this.$refs.form;if(e.validate(),!e.hasError){this.loading=!0;var n=JSON.parse(JSON.stringify(this.section));delete n.enums,n.options={};var i,a=r(this.section.options);try{for(a.s();!(i=a.n()).done;){var l=i.value;n.options[l.name]=l.value}}catch(c){a.e(c)}finally{a.f()}n.options=JSON.stringify(n.options),this.$request(this.$AdminApi.SectionsAdmin.AddSection,n,!0).then(s()(o.a.mark((function e(){return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$successNotify(),e.next=3,t.$store.dispatch("loadAllSections");case 3:return e.next=5,t.$store.dispatch("setAllRoutes");case 5:t.$router.replace({name:"SectionsAdmin"});case 6:case"end":return e.stop()}}),e)})))).catch((function(e){t.$errorNotify(e),t.loading=!1}))}}},beforeCreate:function(){this.$options.components.SectionForm=n("c7eb").SectionForm},created:function(){this.title=this.$tl("title"),this.getSectionTemplate()}}}).call(this,n("7c53")["default"])}}]);