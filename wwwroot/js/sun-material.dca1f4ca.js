(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"118b":function(t,e,a){"use strict";a.d(e,"d",(function(){return r})),a.d(e,"a",(function(){return l})),a.d(e,"c",(function(){return n})),a.d(e,"b",(function(){return o}));a("ddb0"),a("ac1f"),a("498a");var i=a("2b0e"),s=a("3956");function r(){const t=c(s["i"].state.categories.root);return[...t.children]}function l(t){return t.includes(",")?o(t):n(t)}function n(t){let e=c(s["i"].getters.getCategory(t));return e=e.selectable?[e]:[...e.children],e}function o(t){const e=t.split(",").map((t=>t.trim())),a=[];for(let i of e){const t=c(s["i"].getters.getCategory(i));t&&a.push(t)}return a}function c(t){var e;if(!t)return null;let a;if(t.subCategories){a=[];for(let e of t.subCategories){let t=c(e);t&&a.push(t)}}a&&0===a.length&&(a=null);const s={title:t.title,name:t.name,category:t,children:a,selectable:!1};if(null!==(e=t.categoryPersonalAccess)&&void 0!==e&&e.MaterialWrite)t.isMaterialsContainer?(s.icon=i["default"].prototype.$iconsSet.global.category,s.iconColor="green-5",s.selectable=!0):a&&(s.selectable=!1);else if(!a)return null;return s}},"176d":function(t,e,a){},"2aac":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("SunPage",{staticClass:"material"},[t.material?a("div",{staticClass:"page-padding"},[a("article",[t.showTitle?a("PageHeader",{attrs:{title:t.material.title,subTitle:t.material.subTitle}}):t._e(),t.carouselImages?a("q-carousel",{staticClass:"material__carousel",attrs:{"transition-prev":"jump-right","transition-next":"jump-left",swipeable:"",animated:"","control-color":"carousel",navigation:"",infinite:"",fullscreen:t.isFullscreenCarousel,padding:"",arrows:""},on:{"update:fullscreen":function(e){t.isFullscreenCarousel=e}},scopedSlots:t._u([{key:"control",fn:function(){return[a("q-carousel-control",{attrs:{position:"bottom-right",offset:[12,75]}},[a("q-btn",{attrs:{push:"",round:"",dense:"",color:"white","text-color":"primary",icon:t.isFullscreenCarousel?t.$iconsSet.Material.fullscreen:t.$iconsSet.Material.fullscreenExit},on:{click:function(e){t.isFullscreenCarousel=!t.isFullscreenCarousel}}})],1)]},proxy:!0}],null,!1,1939852203),model:{value:t.carouselCurrent,callback:function(e){t.carouselCurrent=e},expression:"carouselCurrent"}},t._l(t.carouselImages,(function(t){return a("q-carousel-slide",{key:t,staticClass:"column no-wrap flex-center",attrs:{name:t}},[a("img",{staticClass:"material__carousel--img",attrs:{src:t}})])})),1):t._e(),a("div",{staticClass:"material__text q-mb-lg",domProps:{innerHTML:t._s(t.material.text)}}),a("footer",[t.showFooter&&t.material.tags&&t.material.tags.length>0?a("div",{staticClass:"material__tags q-mt-lg"},[t._v("\n\t\t\t\t\t\t"+t._s(t.$tl("tags"))+"\n\t\t\t\t\t\t"),t._l(t.material.tags,(function(e){return a("q-chip",{key:e,staticClass:"q-mx-xs",attrs:{dense:""}},[t._v("\n\t\t\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t\t\t")])}))],2):t._e(),t.showFooter?a("div",{staticClass:"material__footer q-gutter-x-lg q-py-sm flex align-center"},[t.showUser?a("div",{staticClass:"material__author q-mr-md"},[a("router-link",{staticClass:"link user-link",attrs:{to:{name:"User",params:{link:t.material.authorLink}}}},[a("q-avatar",{staticClass:"avatar material__avatar"},[a("img",{attrs:{src:t.$avatarPath(t.material.authorAvatar)}})]),t._v(t._s(t.material.authorName)+"\n\t\t\t\t\t\t\t")],1)],1):t._e(),a("q-space"),t.canEdit?a("div",{staticClass:"material-edit-btn edit-btn-block"},[a("a",{staticClass:"link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.$router.push({name:"EditMaterial",params:{id:t.material.id}})}}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.$tl("edit")))])]):t._e(),!t.material.deletedDate&&t.canDelete?a("div",{staticClass:"material-footer-info-block"},[a("a",{staticClass:"link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.deleteMaterial.apply(null,arguments)}}},[a("q-icon",{attrs:{name:t.$iconsSet.Material.delete}})],1)]):t._e(),t.material.deletedDate&&t.canRestore?a("div",{staticClass:"material-footer-info-block"},[a("a",{staticClass:"link",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.restoreMaterial.apply(null,arguments)}}},[a("q-icon",{attrs:{name:t.$iconsSet.Material.restore}})],1)]):t._e(),t.showVisitsCount?a("div",{staticClass:"material__visits material-footer-info-block"},[a("q-icon",{staticClass:"q-mr-xs",attrs:{name:t.$iconsSet.Material.visits}}),t._v("\n\t\t\t\t\t\t\t"+t._s(t.material.visitsCount)+"\n\t\t\t\t\t\t")],1):t._e(),t.showDate?a("div",{staticClass:"material__date material-footer-info-block"},[a("q-icon",{staticClass:"q-mr-xs",attrs:{name:t.$iconsSet.Material.publishDate}}),a("time",{attrs:{datetime:t.$formatToSemTime(t.material.publishDate)}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.$formatDate(t.material.publishDate))+"\n\t\t\t\t\t\t\t")])],1):t._e()],1):t._e()])],1),a("div",{staticClass:"clear"})]):t._e(),t.material&&t.comments&&t.comments.length>0?a("div",{staticClass:"material__comments",attrs:{id:"material-comments"}},[a("hr",{staticClass:"material__comments-sep"}),t._l(t.comments,(function(e,i){return a("div",{key:e.id},[a("CommentContainer",{staticClass:"page-padding",attrs:{comment:e,checkLastOwn:t.checkLastOwn,categoryPersonalAccess:t.categoryPersonalAccess,isLast:i===t.maxCommentNumber}}),a("hr",{staticClass:"material__comments-sep"})],1)}))],2):t._e(),t.material&&t.comments?t._e():a("LoaderWait"),t.material&&t.comments&&t.canCommentWrite?a("div",{staticClass:"material__write-comment q-mt-md"},[a("CreateComment",{staticClass:"page-padding",attrs:{materialId:t.material.id},on:{done:t.commentAdded}})],1):t._e()],1)},s=[],r=a("2ce9"),l=r["a"],n=(a("496b"),a("2877")),o=a("880c"),c=a("32a7"),m=a("9c40"),u=a("62cd"),d=a("b047"),h=a("cb32"),g=a("2c91"),f=a("0016"),p=a("eebe"),b=a.n(p),$=Object(n["a"])(l,i,s,!1,null,null,null);e["a"]=$.exports;b()($,"components",{QCarousel:o["a"],QCarouselControl:c["a"],QBtn:m["a"],QCarouselSlide:u["a"],QChip:d["a"],QAvatar:h["a"],QSpace:g["a"],QIcon:f["a"]})},"2ce9":function(t,e,a){"use strict";(function(t){var i=a("9d68"),s=a("4cc9"),r=a("8a9f"),l=a("c8f1"),n=a("a4c0"),o=a("6e68"),c=a("06d5"),m=(a("cdde"),a("bd4c")),u=a("0831");const{getScrollTarget:d,setScrollPosition:h}=u["a"];e["a"]={name:"Material",mixins:[t],props:{idOrName:{type:String,required:!0},categoryName:{type:String,required:!0}},data(){return{material:null,comments:null,page:null,headersPrepared:!1,carouselImages:null,carouselCurrent:null,isFullscreenCarousel:!1}},watch:{$route(t,e){if(t.path!==e.path)this.loadData();else{const t=document.getElementById(this.$route.hash.substring(1));h(d(t),t.offsetTop,300)}}},computed:{maxCommentNumber(){return this.comments.length-1},category(){return this.$store.getters.getCategory(this.categoryName)},showTitle(){var t,e;return this.category&&!(null!==(t=this.category.settingsJson)&&void 0!==t&&t.hideTitle||null!==(e=this.material.settingsJson)&&void 0!==e&&e.hideTitle)},hideBreadcrumbs(){var t,e,a,i;return(null===(t=this.category)||void 0===t||null===(e=t.settingsJson)||void 0===e?void 0:e.hideBreadcrumbs)||(null===(a=this.material)||void 0===a||null===(i=a.settingsJson)||void 0===i?void 0:i.hideBreadcrumbs)},showDate(){return this.category&&(this.showFooter||this.canEdit)},showVisitsCount(){return this.category&&(this.showFooter||this.canEdit)},showUser(){return this.category&&(this.showFooter||this.canEdit)},showFooter(){var t,e;return!!this.category&&(!!this.category.categoryPersonalAccess.MaterialEditAny||!(null!==(t=this.category.settingsJson)&&void 0!==t&&t.hideFooter||null!==(e=this.material.settingsJson)&&void 0!==e&&e.hideFooter))},canCommentWrite(){return!(!this.material||this.material.isCommentsBlocked)&&this.category.categoryPersonalAccess.CommentWrite},categoryPersonalAccess(){return this.category.categoryPersonalAccess},canEdit(){if(!this.material||!this.comments)return!1;if(!this.$store.state.auth.user)return!1;const t=this.$store.getters.getCategory(this.material.categoryName);if(t.categoryPersonalAccess.MaterialEditAny)return!0;if(this.material.authorId!==this.$store.state.auth.user.id)return!1;if(!t.categoryPersonalAccess.MaterialEditOwnIfHasReplies&&this.comments.length>=1&&!this.checkLastOwn(this.comments[0]))return!1;if(!t.categoryPersonalAccess.MaterialEditOwnIfTimeNotExceeded){const t=new Date,e=new Date(this.material.publishDate),a=m["a"].addToDate(e,{minutes:config.Materials.TimeToOwnEditInMinutes});if(a<t)return!1}return!!t.categoryPersonalAccess.MaterialEditOwn},canDelete(){return r["a"].call(this)},canRestore(){return l["a"].call(this)}},methods:{loadDataMaterial(){return this.$request(this.$Api.Materials.Get,{idOrName:this.idOrName}).then((t=>{if(this.material=t.data,this.material.settingsJson)try{this.material.settingsJson=JSON.parse(this.material.settingsJson)}catch(e){}this.title=this.material.title,this.$nextTick((()=>{var t;this.preapairCarousel(),n["a"].call(this,this.$el,"material__text"),o["a"].call(this,this.$el,"material__text"),null!==(t=this.material.settingsJson)&&void 0!==t&&t.allowInnerJavaScript&&Object(c["a"])(this.$el)}))}))},preapairCarousel(){const t=Array.from(this.$el.getElementsByTagName("img")),e=t.filter((t=>t.hasAttribute("carousel")));e&&0!==e.length&&(this.carouselImages=e.map((t=>t.getAttribute("src"))),this.carouselCurrent=this.carouselImages[0],e.forEach((t=>t.remove())))},async loadDataComments(){await this.$request(this.$Api.Comments.GetMaterialComments,{materialId:this.material.id}).then((t=>{this.comments=t.data,this.$nextTick((function(){if(this.$route.hash){const t=document.getElementById(this.$route.hash.substring(1));h(d(t),t.offsetTop,300)}}))}))},checkLastOwn(t){if(!this.comments)return!1;let e=this.$store.state.auth.user.id,a=this.comments.indexOf(t);for(let i=a;i<this.comments.length;i++)if(this.comments[i].authorId!==e)return!1;return!0},async deleteMaterial(){i["a"].call(this)},async restoreMaterial(){s["a"].call(this)},async commentAdded(){let t=this.$route.fullPath,e=t.lastIndexOf("#"),a=t.substring(0,e);window.history.pushState("",document.title,a),await this.loadData()},async loadData(){this.headersPrepared=!1,await this.loadDataMaterial(),await this.loadDataComments()}},beforeCreate(){this.$options.centered=!0,this.$options.components.CommentContainer=a("9302").CommentContainer,this.$options.components.CreateComment=a("9302").CreateComment,this.$options.components.Article=a("f439").Article},created(){this.loadData()}}}).call(this,a("7c53")["default"])},"3b70":function(t,e,a){"use strict";a("176d")},"496b":function(t,e,a){"use strict";a("e801")},"4a0e":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("SunPage",{staticClass:"create-material q-pa-md"},[a("MaterialForm",{ref:"form",staticClass:"create-material__material-form",attrs:{material:t.material,categoriesNames:t.categoriesNames}}),a("div",{staticClass:"create-material__btn-block q-mt-md"},[a("q-btn",{staticClass:"send-btn",attrs:{icon:t.$iconsSet.CreateMaterial.save,"no-caps":"",loading:t.loading,label:t.$tl("sendBtn"),color:"send"},on:{click:t.send}},[a("LoaderSent",{attrs:{slot:"loading"},slot:"loading"})],1),a("q-btn",{staticClass:"cancel-btn q-ml-sm",attrs:{"no-caps":"",icon:t.$iconsSet.CreateMaterial.cancel,label:t.$t("Global.btn.cancel"),color:"warning"},on:{click:function(e){return t.$router.back()}}})],1)],1)},s=[],r=a("5469"),l=r["a"],n=a("2877"),o=a("9c40"),c=a("eebe"),m=a.n(c),u=Object(n["a"])(l,i,s,!1,null,null,null);e["a"]=u.exports;m()(u,"components",{QBtn:o["a"]})},"4cc9":function(t,e,a){"use strict";e["a"]=function(){const t=this.$tl("restoreDialogTitle"),e=this.$tl("restoreDialogMessage"),a=this.$tl("restoreDialogOk"),i=this.$tl("restoreDialogCancel");this.$q.dialog({title:t,message:e,ok:a,cancel:i}).onOk((()=>{this.$request(this.$Api.Materials.Restore,{id:this.material.id}).then((()=>{const t=this.$tl("restoreSuccess");this.$successNotify(t),this.$router.push(this.category.getRoute())})).catch((t=>{console.log("error",t)}))}))}},5469:function(t,e,a){"use strict";(function(t,i){a("ac1f"),a("5319");e["a"]={name:"CreateMaterial",mixins:[t],props:{categoriesNames:{type:String,required:!0},categoriesNamesExclude:{type:String,required:!1},initialCategoryName:{type:String,required:!1,default:""}},data(){const t=()=>{if(this.initialCategoryName){var t;const e=this.$store.getters.getCategory(this.initialCategoryName);return e&&e.isMaterialsContainer&&null!==(t=e.categoryPersonalAccess)&&void 0!==t&&t.MaterialWrite?this.initialCategoryName:null}return null};return{material:{name:null,title:"",text:"",subTitle:null,settingsJson:null,tags:[],categoryName:t(),isCommentsBlocked:!1,isHidden:!1},loading:!1}},methods:{send(){if(this.$refs.form.start=!1,this.$refs.form.validate(),this.$refs.form.hasError)return;this.loading=!0;const t={categoryName:this.material.categoryName,title:this.material.title,text:this.material.text,tags:this.material.tags.join(","),isHidden:this.material.isHidden,isCommentsBlocked:this.material.isCommentsBlocked};this.material.name&&(t.name=this.material.name),this.material.subTitle&&(t.subTitle=this.material.subTitle),this.material.settingsJson&&(t.settingsJson=this.material.settingsJson),this.$request(this.$Api.Materials.Create,t).then((()=>{this.$successNotify();this.$refs.form.category.getRoute();this.$router.replace(this.$refs.form.category.getRoute())})).catch((t=>{this.$errorNotify(t),this.loading=!1}))}},beforeCreate(){this.$options.components.MaterialForm=i("material","MaterialForm")},created(){this.title=this.$tl("title")}}}).call(this,a("7c53")["default"],a("9bb5")["default"])},"57a3":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("SunPage",{staticClass:"edit-material q-pa-md"},[t.material.deletedDate?a("div",{staticClass:"edit-material__delete-date text-red"},[a("q-chip",{attrs:{icon:"fas fa-trash",color:"red","text-color":"white",label:t.$tl("deleted")}})],1):t._e(),a("MaterialForm",{ref:"form",staticClass:"edit-material__material-form",attrs:{material:t.material}}),a("div",{staticClass:"edit-material__btn-block flex q-gutter-md q-mt-lg"},[a("q-btn",{staticClass:"send-btn",attrs:{icon:t.$iconsSet.EditMaterial.save,"no-caps":"",loading:t.loading,label:t.$tl("saveBtn")},on:{click:t.save}},[a("LoaderSent",{attrs:{slot:"loading"},slot:"loading"})],1),a("q-btn",{staticClass:"cancel-btn",attrs:{"no-caps":"",icon:t.$iconsSet.EditMaterial.cancel,label:t.$tl("cancelBtn")},on:{click:function(e){return t.$router.back()}}}),a("q-space"),!t.material.deletedDate&&t.canDelete?a("q-btn",{staticClass:"delete-btn",attrs:{"no-caps":"",icon:t.$iconsSet.EditMaterial.delete,label:t.$tl("deleteBtn")},on:{click:t.deleteMaterial}}):t._e(),t.material.deletedDate&&t.canRestore?a("q-btn",{staticClass:"restore-btn",attrs:{"no-caps":"",icon:"fas fa-trash-restore",label:t.$tl("restoreBtn")},on:{click:t.restoreMaterial}}):t._e()],1)],1)},s=[],r=a("b785"),l=r["a"],n=a("2877"),o=a("b047"),c=a("9c40"),m=a("2c91"),u=a("eebe"),d=a.n(u),h=Object(n["a"])(l,i,s,!1,null,null,null);e["a"]=h.exports;d()(h,"components",{QChip:o["a"],QBtn:c["a"],QSpace:m["a"]})},"8a9f":function(t,e,a){"use strict";var i=a("bd4c");e["a"]=function(){if(!this.material||!this.comments)return!1;if(!this.$store.state.auth.user)return!1;if(this.category.categoryPersonalAccess.MaterialDeleteAny)return!0;if(this.material.authorId!==this.$store.state.auth.user.id)return!1;if(!this.category.categoryPersonalAccess.MaterialDeleteOwnIfHasReplies&&this.comments.length>=1&&!this.checkLastOwn(this.comments[0]))return!1;if(!this.category.categoryPersonalAccess.MaterialDeleteOwnIfTimeNotExceeded){const t=new Date,e=this.material.publishDate,a=i["a"].addToDate(e,{minutes:config.Materials.TimeToOwnDeleteInMinutes});if(a<t)return!1}return!!this.category.categoryPersonalAccess.MaterialDeleteOwn}},"9d68":function(t,e,a){"use strict";e["a"]=function(){const t=this.$tl("deleteDialogTitle"),e=this.$tl("deleteDialogMessage"),a=this.$tl("deleteDialogOk"),i=this.$tl("deleteDialogCancel");this.$q.dialog({title:t,message:e,ok:a,cancel:i}).onOk((()=>{this.$request(this.$Api.Materials.Delete,{id:this.material.id}).then((()=>{const t=this.$tl("deleteSuccess");this.$successNotify(t),this.$router.push(this.category.getRoute())})).catch((t=>{console.log("error",t)}))}))}},a84c:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"material-form q-gutter-y-xs"},[t.canEditName?a("q-input",{ref:"name",staticClass:"material-form__name",attrs:{label:t.$tl("name"),rules:t.rules.name},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{color:"info",name:t.$iconsSet.global.tooltip}},[a("q-tooltip",[t._v("\n\t\t\t\t\t\t"+t._s(t.$tl("tooltips.name"))+"\n\t\t\t\t\t")])],1)]},proxy:!0}],null,!1,3054781001),model:{value:t.material.name,callback:function(e){t.$set(t.material,"name",e)},expression:"material.name"}}):t._e(),a("q-input",{ref:"title",staticClass:"material-form__title",attrs:{label:t.$tl("title"),rules:t.rules.title},model:{value:t.material.title,callback:function(e){t.$set(t.material,"title",e)},expression:"material.title"}}),t.isSubTitleEditable?a("q-input",{ref:"subTitle",staticClass:"material-form__sub-title q-mb-sm",attrs:{type:"textarea",autogrow:"",label:t.$tl("subTitle"),rules:t.rules.subTitle},model:{value:t.material.subTitle,callback:function(e){t.$set(t.material,"subTitle",e)},expression:"material.subTitle"}}):t._e(),a("SunEditor",{ref:"htmlEditor",staticClass:"material-form__text-editor",attrs:{bottomSlots:"","content-class":"material__text",toolbar:t.editorToolbar,rules:t.rules.text},model:{value:t.material.text,callback:function(e){t.$set(t.material,"text",e)},expression:"material.text"}}),a("q-select",{staticClass:"material-form__tags",attrs:{"bottom-slots":"","use-input":"","use-chips":"",multiple:"",label:t.$tl("tags"),"hide-dropdown-icon":"","input-debounce":"0","new-value-mode":"add-unique"},scopedSlots:t._u([{key:"prepend",fn:function(){return[a("q-icon",{attrs:{name:t.$iconsSet.MaterialForm.tags}})]},proxy:!0}]),model:{value:t.material.tags,callback:function(e){t.$set(t.material,"tags",e)},expression:"material.tags"}}),a("CategoriesInput",{ref:"categoryName",attrs:{categoriesNames:t.categoriesNames,showIcon:"",allowNull:!1,showIcons:"",label:t.$tl("selectCategory")},model:{value:t.material.categoryName,callback:function(e){t.$set(t.material,"categoryName",e)},expression:"material.categoryName"}}),t.canEditSettingsJson?a("q-input",{ref:"settingsJson",staticClass:"material-form__settings-json",attrs:{type:"textarea",clearable:"",autogrow:"",label:t.$tl("settingsJson"),rules:t.rules.settingsJson},model:{value:t.material.settingsJson,callback:function(e){t.$set(t.material,"settingsJson",e)},expression:"material.settingsJson"}}):t._e(),a("div",{staticClass:"material-form__block-comments"},[t.canBlockComments?a("q-checkbox",{ref:"isCommentsBlocked",attrs:{"toggle-indeterminate":!1,label:t.$tl("blockComments")},model:{value:t.material.isCommentsBlocked,callback:function(e){t.$set(t.material,"isCommentsBlocked",e)},expression:"material.isCommentsBlocked"}}):t._e()],1),a("div",{staticClass:"material-form__hide"},[t.canHide?a("q-checkbox",{ref:"isHidden",attrs:{"toggle-indeterminate":!1,label:t.$tl("hide")},model:{value:t.material.isHidden,callback:function(e){t.$set(t.material,"isHidden",e)},expression:"material.isHidden"}}):t._e()],1)],1)},s=[],r=(a("e01a"),a("6fb1"));function l(){return{name:[t=>!t||/^[a-zA-Z0-9-]+$/.test(t)||this.$tl("validation.name.allowedChars"),t=>!t||!/^[0-9]+$/.test(t)||this.$tl("validation.name.numberNotAllowed"),t=>!t||t.length>=3||this.$tl("validation.name.minLength"),t=>!t||t.length<=config.DbColumnSizes.Materials_Name||this.$tl("validation.name.maxLength")],title:[t=>!!t||this.$tl("validation.title.required"),t=>t.length>=3||this.$tl("validation.title.minLength"),t=>t.length<=config.DbColumnSizes.Materials_Title||this.$tl("validation.title.maxLength")],subTitle:[t=>!t||t.length<=config.DbColumnSizes.Materials_SubTitle||this.$tl("validation.subTitle.maxLength")],text:[t=>!!t||this.$tl("validation.text.required"),t=>{var e,a,i;return Object(r["htmlTextSizeOrHasImage"])(null===(e=this.$refs)||void 0===e||null===(a=e.htmlEditor)||void 0===a||null===(i=a.$refs)||void 0===i?void 0:i.content,5)||this.$tl("validation.text.htmlTextSizeOrHasImage")}],settingsJson:[t=>!t||Object(r["isJson"])(t)||this.$tl("validation.settingsJson.jsonFormatError")]}}var n={name:"MaterialForm",props:{material:{type:Object,required:!0},categoriesNames:{type:String,required:!1,default:"Root"}},data(){return{start:!0}},computed:{hasError(){var t,e;return this.$refs.title.hasError||this.$refs.htmlEditor.hasError||!this.material.categoryName||(null===(t=this.$refs.description)||void 0===t?void 0:t.hasError)||(null===(e=this.$refs.name)||void 0===e?void 0:e.hasError)},canEditName(){var t;return this.$store.state.auth.roles.includes("Admin")&&(null===(t=this.category)||void 0===t?void 0:t.isMaterialsNameEditable)},canHide(){var t,e;return null===(t=this.category)||void 0===t||null===(e=t.categoryPersonalAccess)||void 0===e?void 0:e.MaterialHide},canEditSettingsJson(){var t,e;return null===(t=this.category)||void 0===t||null===(e=t.categoryPersonalAccess)||void 0===e?void 0:e.MaterialEditSettingsJson},canBlockComments(){var t,e;return null===(t=this.category)||void 0===t||null===(e=t.categoryPersonalAccess)||void 0===e?void 0:e.MaterialBlockCommentsAny},categoryTitle(){var t;return null===(t=this.category)||void 0===t?void 0:t.title},category(){return this.$store.getters.getCategory(this.material.categoryName)},isSubTitleEditable(){var t;return null===(t=this.category)||void 0===t?void 0:t.isMaterialsSubTitleEditable}},methods:{validate(){var t,e,a,i;null===(t=this.$refs.name)||void 0===t||t.validate(),this.$refs.title.validate(),null===(e=this.$refs.subTitle)||void 0===e||e.validate(),this.$refs.htmlEditor.validate(),null===(a=this.$refs.settingsJson)||void 0===a||a.validate(),null===(i=this.$refs.categoryName)||void 0===i||i.validate()}},beforeCreate(){this.rules=l.call(this),this.editorToolbar=JSON.parse(config.Editor.MaterialToolbar),this.$options.components.CategoriesInput=a("a996").CategoriesInput}},o=n,c=(a("3b70"),a("2877")),m=a("27f9"),u=a("0016"),d=a("05c0"),h=a("ddd8"),g=a("8f8e"),f=a("d66b"),p=a("eebe"),b=a.n(p),$=Object(c["a"])(o,i,s,!1,null,null,null);e["a"]=$.exports;b()($,"components",{QInput:m["a"],QIcon:u["a"],QTooltip:d["a"],QSelect:h["a"],QCheckbox:g["a"],QEditor:f["a"]})},b785:function(t,e,a){"use strict";(function(t){a("ac1f"),a("5319");var i=a("b707");e["a"]={name:"EditMaterial",mixins:[t],props:{id:{type:Number,required:!0}},data(){return{material:{name:null,title:"",text:"",subTitle:null,settingsJson:null,tags:[],isHidden:!1,isBlockComments:!1},comments:null,loading:!1}},computed:{categoryNodes(){return Object(i["getWhereToMove"])(this.$store)},category(){return this.$store.getters.getCategory(this.material.categoryName)},canDelete(){return i["canDeleteMaterial"].call(this)},canRestore(){return i["canRestoreMaterial"].call(this)}},methods:{deleteMaterial(){i["deleteMaterial"].call(this)},restoreMaterial(){i["restoreMaterial"].call(this)},async save(){if(this.$refs.form.start=!1,this.$refs.form.validate(),this.$refs.form.hasError)return;this.loading=!0;const t={id:this.id,categoryName:this.material.categoryName,title:this.material.title,text:this.material.text,tags:this.material.tags.join(","),isHidden:this.material.isHidden,isCommentsBlocked:this.material.isCommentsBlocked};this.material.name&&(t.name=this.material.name),this.material.subTitle&&(t.subTitle=this.material.subTitle),this.material.settingsJson&&(t.settingsJson=this.material.settingsJson),await this.$request(this.$Api.Materials.Update,t).then((()=>{this.$successNotify(),this.$router.replace(this.category.getRoute())})).catch((t=>{this.$errorNotify(t),this.loading=!1}))},async loadData(){await this.$request(this.$Api.Materials.Get,{idOrName:this.id}).then((t=>{this.material=t.data})),await this.$request(this.$Api.Comments.GetMaterialComments,{materialId:this.material.id}).then((t=>{this.comments=t.data}))}},beforeCreate(){this.$options.components.MaterialForm=a("b707").MaterialForm},created(){this.title=this.$tl("title"),this.loadData()}}}).call(this,a("7c53")["default"])},c18f:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.material?a("div",{staticClass:"material-inline full-height"},[a("div",{staticClass:"material-inline__text full-height",domProps:{innerHTML:t._s(t.material.text)}})]):t._e()},s=[],r=a("06d5"),l=a("a4c0"),n=a("6e68"),o={name:"MaterialInline",props:{name:{type:String,required:!0}},data(){return{material:null}},methods:{loadMaterial(){this.$request(this.$Api.Materials.Get,{idOrName:this.name}).then((t=>{if(this.material=t.data,this.material.settingsJson)try{this.material.settingsJson=JSON.parse(this.material.settingsJson)}catch(e){}this.$emit("loaded"),this.$nextTick((t=>{n["a"].call(this,this.$el,"material-inline__text"),l["a"].call(this,this.$el,"material-inline__text"),Object(r["a"])(this.$el)}))})).catch((t=>{console.log("error",t)}))}},created(){this.loadMaterial()}},c=o,m=a("2877"),u=Object(m["a"])(c,i,s,!1,null,null,null);e["a"]=u.exports},c8f1:function(t,e,a){"use strict";e["a"]=function(){return this.category.categoryPersonalAccess.MaterialDeleteAny}},e801:function(t,e,a){}}]);