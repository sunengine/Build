(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"07aa":function(e,t,s){"use strict";s("e24b")},"12d1":function(e,t,s){},"33ba":function(e,t,s){"use strict";(function(e){s("ddb0"),s("ac1f"),s("5319");t["a"]={name:"CreateSection",mixins:[e],props:{templateName:{type:String,required:!0}},data(){return{section:null,loading:!1}},computed:{breadcrumbsCategory(){return this.$getBreadcrumbs("SectionsAdmin")}},methods:{getSectionTemplate(){this.$request(this.$AdminApi.SectionsAdmin.GetSectionTemplate,{templateName:this.templateName}).then((e=>{this.section=e.data}))},save(){const e=this.$refs.form;if(e.validate(),e.hasError)return;this.loading=!0;const t=JSON.parse(JSON.stringify(this.section));delete t.enums,t.options={};for(const s of this.section.options)t.options[s.name]=s.value;t.options=JSON.stringify(t.options),this.$request(this.$AdminApi.SectionsAdmin.AddSection,t,!0).then((async()=>{this.$successNotify(),await this.$store.dispatch("loadAllSections"),await this.$store.dispatch("setAllRoutes"),this.$router.replace({name:"SectionsAdmin"})})).catch((e=>{this.$errorNotify(e),this.loading=!1}))}},beforeCreate(){this.$options.components.SectionForm=s("c7eb").SectionForm},created(){this.title=this.$tl("title"),this.getSectionTemplate()}}}).call(this,s("7c53")["default"])},"5f91":function(e,t,s){"use strict";s("a8d9")},6644:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",["Boolean"===e.item.type?s("q-checkbox",{attrs:{dense:""},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}}):"Integer"===e.item.type?s("q-input",{ref:"input",attrs:{dense:"",type:"number",value:e.item.value},on:{input:function(t){e.item.value=parseInt(t)}}}):"String"===e.item.type?s("q-input",{ref:"input",attrs:{dense:"",clearable:"",type:"text"},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}}):"LongString"===e.item.type?s("q-input",{ref:"input",attrs:{dense:"",clearable:"",type:"textarea"},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}}):e.enums&&"Enum"===e.item.type?s("q-select",{attrs:{dense:"",options:e.enums[e.item.enum]},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}}):"Tokens"===e.item.type?s("q-select",{attrs:{dense:"",value:e.item.value.split(",").filter((function(e){return e})),"hide-dropdown-icon":"","input-debounce":"0","new-value-mode":"add-unique","use-input":"",multiple:"","use-chips":""},on:{input:function(t){e.item.value=t.join(",")}}}):"Html"===e.item.type?s("SunEditor",{ref:"input",attrs:{height:"5rem","min-height":"3rem",toolbar:[["bold","italic","underline","removeFormat"],["link","addImages"],[{icon:"fas fa-heading",fixedLabel:!0,list:"no-icons",options:["p","h2","h3","h4","h5","h6","code"]},{icon:"fas fa-text-height",fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]}],["unordered","ordered",{icon:"fas fa-align-center",fixedLabel:!0,options:["left","center","right","justify"]}],["undo","redo"],["viewsource","fullscreen"],["clear"]]},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}}):"Json"===e.item.type?s("q-input",{ref:"input",staticClass:"jj",staticStyle:{position:"relative"},attrs:{"input-style":"height:7rem",dense:"",type:"textarea","hide-hint":"","hide-bottom-space":"",rules:e.jsonRules},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}},[s("q-btn",{staticClass:"config-item__pretty-btn",staticStyle:{position:"absolute",top:"5px",right:"24px",display:"none"},attrs:{round:"",dense:"",size:"12px",icon:e.$iconsSet.ConfigItem.pretty},on:{click:e.prepareJson}},[s("q-tooltip",[e._v(e._s(e.$tl("pretty")))])],1)],1):"Roles"===e.item.type?s("q-select",{attrs:{dense:"",options:e.allRoles,multiple:"","use-chips":"","stack-label":"","option-value":"name","option-label":"title"},on:{loadstart:e.prepareRoles},model:{value:e.roles,callback:function(t){e.roles=t},expression:"roles"}}):"Categories"===e.item.type?s("CategoriesInput",{attrs:{categoriesNames:"Root",multiple:"",showRoot:""},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}}):s("q-input",{ref:"input",attrs:{clearable:"",dense:"",type:"text"},model:{value:e.item.value,callback:function(t){e.$set(e.item,"value",t)},expression:"item.value"}})],1)},n=[],a=(s("ac1f"),s("6fb1")),o={name:"ConfigItem",props:{item:{type:Object,required:!0},enums:{type:Object,required:!1},allRoles:{type:Array,required:!0}},data(){return{roles:[]}},watch:{roles:"rolesUpdated"},computed:{jsonRules(){return Object(a["jsonRules"])()},hasError(){var e,t;null===(e=this.$refs)||void 0===e||null===(t=e.input)||void 0===t||t.hasError}},methods:{rolesUpdated(){var e,t,s,i;this.item.value=null!==(e=null===(t=this.roles)||void 0===t||null===(s=t.map((e=>e.name)))||void 0===s||null===(i=s.filter((e=>e)))||void 0===i?void 0:i.join(","))&&void 0!==e?e:""},prepareRoles(){var e,t;const s=null!==(e=null===(t=this.item.value)||void 0===t?void 0:t.split(","))&&void 0!==e?e:[];this.roles=this.allRoles.filter((e=>s.some((t=>t===e.name))))},prepareJson(){this.item.value=JSON.stringify(JSON.parse(this.item.value),null,4)},validate(){var e,t;null===(e=this.$refs)||void 0===e||null===(t=e.input)||void 0===t||t.validate()}},beforeCreate(){this.$options.components.CategoriesInput=s("a996").CategoriesInput},created(){switch(this.item.type){case"Roles":this.prepareRoles();break}}},l=o,c=(s("5f91"),s("2877")),r=s("8f8e"),d=s("27f9"),m=s("ddd8"),u=s("9c40"),p=s("05c0"),h=s("8572"),f=s("eebe"),v=s.n(f),b=Object(c["a"])(l,i,n,!1,null,null,null);t["a"]=b.exports;v()(b,"components",{QCheckbox:r["a"],QInput:d["a"],QSelect:m["a"],QBtn:u["a"],QTooltip:p["a"],QField:h["a"]})},"9c47":function(e,t,s){"use strict";(function(e){s("ddb0"),s("ac1f"),s("5319"),s("11ec");t["a"]={name:"EditSection",mixins:[e],props:{name:{type:String,required:!0}},computed:{breadcrumbsCategory(){return this.$getBreadcrumbs("SectionsAdmin")}},data(){return{section:null,loading:!1}},methods:{save(){const e=this.$refs.form;if(e.validate(),e.hasError)return;this.loading=!0;const t=JSON.parse(JSON.stringify(this.section));delete t.enums,t.options={};for(const s of this.section.options)t.options[s.name]=s.value;t.options=JSON.stringify(t.options),this.$request(this.$AdminApi.SectionsAdmin.UpdateSection,t,!0).then((async()=>{this.$successNotify(),await this.$store.dispatch("loadAllSections"),await this.$store.dispatch("setAllRoutes"),this.$router.replace({name:"SectionsAdmin"})})).catch((e=>{this.$errorNotify(e),this.loading=!1}))},removeSection(){const e=this.$tl("deleteMsg"),t=this.$tl("btnDeleteOk"),s=this.$tl("btnDeleteCancel");this.$q.dialog({message:e,ok:t,cancel:s}).onOk((()=>this.$request(this.$AdminApi.SectionsAdmin.DeleteSection,{sectionId:this.section.id}).then((()=>{this.$successNotify(null,"warning"),this.$router.push({name:"SectionsAdmin"})})).catch((e=>{this.$errorNotify(e),this.loading=!1}))))},loadData(){this.$request(this.$AdminApi.SectionsAdmin.GetSection,{name:this.name}).then((e=>{this.section=e.data}))}},beforeCreate(){this.$options.components.SectionForm=s("c7eb").SectionForm},created(){this.title=this.$tl("title"),this.loadData()}}}).call(this,s("7c53")["default"])},"9d98":function(e,t,s){"use strict";s("12d1")},a2ec:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"section-form q-gutter-sm"},[e.section.options&&e.section.options.length>0&&e.allRoles?s("q-markup-table",{attrs:{flat:"",bordered:"","wrap-cells":""}},[s("tr",[s("td",{staticClass:"config-item__name-column"},[e._v(e._s(e.$tl("type")))]),s("td",[e._v("\n\t\t\t\t"+e._s(e.$t("SectionsEditor."+e.section.type+".name"))+"\n\t\t\t")])]),s("tr",[s("td",{staticClass:"config-item__name-column"},[e._v(e._s(e.$tl("name")))]),s("td",[s("q-input",{ref:"name",staticClass:"section-form__name",attrs:{dense:"","hide-bottom-space":"","hide-hint":"",rules:e.rules.name},model:{value:e.section.name,callback:function(t){e.$set(e.section,"name",t)},expression:"section.name"}})],1)]),s("tr",[s("td",{staticClass:"config-item__name-column"},[e._v(e._s(e.$tl("token")))]),s("td",[s("q-input",{ref:"token",staticClass:"section-form__name",attrs:{dense:"","hide-bottom-space":"","hide-hint":"",rules:e.rules.token},model:{value:e.section.token,callback:function(t){e.$set(e.section,"token",t)},expression:"section.token"}})],1)]),s("tr",[s("td",{staticClass:"config-item__name-column"},[e._v(e._s(e.$tl("roles")))]),s("td",[e.allRoles?s("q-select",{staticClass:"section-form__title",attrs:{dense:"",options:e.allRoles,multiple:"","use-chips":"","stack-label":"","option-value":"name","option-label":"title"},model:{value:e.roles,callback:function(t){e.roles=t},expression:"roles"}}):s("LoaderWait")],1)]),s("tr",[s("td",{staticClass:"config-item__name-column"},[e._v(e._s(e.$tl("isCacheData")))]),s("td",[s("q-checkbox",{ref:"isCacheData",staticClass:"section-form__is-cache-data",attrs:{dense:""},model:{value:e.section.isCacheData,callback:function(t){e.$set(e.section,"isCacheData",t)},expression:"section.isCacheData"}})],1)]),e._l(e.section.options,(function(t){return s("tr",{key:t.name},[s("td",[e._v(e._s(e.$t("SectionsEditor."+e.section.type+"."+t.name)))]),s("td",[s("ConfigItem",{ref:"configItem",refInFor:!0,attrs:{allRoles:e.allRoles,item:t,enums:e.section.enums}})],1)])}))],2):e._e()],1)},n=[];s("ac1f");function a(){return{name:[e=>!!e||this.$tl("validation.name.required"),e=>!e||e.length>=3||this.$tl("validation.name.minLength"),e=>!e||e.length<=config.DbColumnSizes.MenuItems_Name||this.$tl("validation.name.maxLength"),e=>/^[a-zA-Z0-9_-]*$/.test(e)||this.$tl("validation.name.allowedChars")],token:[e=>!e||e.length<=config.DbColumnSizes.Sections_Token||this.$tl("validation.token.maxLength"),e=>/^[a-zA-Z0-9-]*$/.test(e)||this.$tl("validation.token.allowedChars")],type:[e=>!!e||this.$tl("validation.type.required")]}}var o={name:"SectionForm",props:{section:{type:Object,required:!0},editMode:{type:Boolean,required:!1,default:!1}},data(){return{allRoles:null,roles:null}},watch:{roles:"rolesUpdated","section.type":"typeChanges"},computed:{hasError(){return this.$refs.name.hasError||this.$refs["configItem"].some((e=>e.hasError))}},methods:{rolesUpdated(){this.section.roles=this.roles.map((e=>e.name)).join(",")},validate(){this.$refs.name.validate(),this.$refs["configItem"].forEach((e=>e.validate()))},loadRoles(){this.$request(this.$AdminApi.UserRolesAdmin.GetAllRoles).then((e=>{this.allRoles=e.data,this.allRoles.push({name:"Unregistered",title:"Unregistered"});const t=this.section.roles.split(",");this.roles=this.allRoles.filter((e=>t.some((t=>t===e.name))))}))}},beforeCreate(){this.$options.components.ConfigItem=s("c7eb").ConfigItem},created(){this.rules=a.call(this),this.loadRoles()}},l=o,c=(s("9d98"),s("2877")),r=s("2bb1"),d=s("27f9"),m=s("ddd8"),u=s("8f8e"),p=s("eebe"),h=s.n(p),f=Object(c["a"])(l,i,n,!1,null,null,null);t["a"]=f.exports;h()(f,"components",{QMarkupTable:r["a"],QInput:d["a"],QSelect:m["a"],QCheckbox:u["a"]})},a8d9:function(e,t,s){},d2f2:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("SunPage",{staticClass:"create-section page-padding"},[s("PageHeader",{attrs:{title:e.title}}),e.section?s("SectionForm",{ref:"form",staticClass:"q-mb-xl",attrs:{editMode:!1,section:e.section}}):e._e(),s("div",{staticClass:"create-section__btn-block q-mt-lg q-gutter-md"},[s("q-btn",{staticClass:"send-btn",attrs:{icon:e.$iconsSet.CreateSection.add,"no-caps":"",loading:e.loading,label:e.$tl("createBtn"),color:"send"},on:{click:e.save}},[s("LoaderSent",{attrs:{slot:"loading"},slot:"loading"})],1),s("q-btn",{staticClass:"cancel-btn",attrs:{"no-caps":"",icon:e.$iconsSet.CreateSection.cancel,label:e.$tl("cancelBtn"),color:"warning"},on:{click:function(t){return e.$router.back()}}})],1)],1)},n=[],a=s("33ba"),o=a["a"],l=s("2877"),c=s("9c40"),r=s("eebe"),d=s.n(r),m=Object(l["a"])(o,i,n,!1,null,"574d9211",null);t["a"]=m.exports;d()(m,"components",{QBtn:c["a"]})},e24b:function(e,t,s){},ed28:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("SunPage",{staticClass:"edit-section page-padding"},[s("PageHeader",{attrs:{title:e.title}}),e.section?s("SectionForm",{ref:"form",staticClass:"q-mb-xl",attrs:{editMode:!0,section:e.section}}):s("LoaderWait"),s("div",{staticClass:"q-gutter-md"},[s("q-btn",{staticClass:"send-btn",attrs:{icon:e.$iconsSet.EditSection.save,"no-caps":"",loading:e.loading,label:e.$tl("saveBtn"),color:"send"},on:{click:e.save}},[s("LoaderSent",{attrs:{slot:"loading"},slot:"loading"})],1),s("q-btn",{staticClass:"cancel-btn q-ml-sm",attrs:{"no-caps":"",icon:e.$iconsSet.EditSection.cancel,label:e.$tl("cancelBtn"),color:"warning"},on:{click:function(t){return e.$router.back()}}}),s("q-btn",{staticClass:"delete-btn q-ml-sm float-right",attrs:{"no-caps":"",icon:e.$iconsSet.EditSection.delete,label:e.$tl("deleteBtn")},on:{click:function(t){return e.removeSection()}}})],1)],1)},n=[],a=s("9c47"),o=a["a"],l=s("2877"),c=s("9c40"),r=s("eebe"),d=s.n(r),m=Object(l["a"])(o,i,n,!1,null,"6619f3fa",null);t["a"]=m.exports;d()(m,"components",{QBtn:c["a"]})},efd5:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("SunPage",{staticClass:"sections-admin page-padding"},[s("PageHeader",{attrs:{title:e.$tl("title")}},[s("q-btn-dropdown",{staticClass:"post-btn q-mr-lg",attrs:{icon:e.$iconsSet.SectionsAdmin.add,type:"a",label:e.$tl("addSectionBtn")}},[s("q-list",e._l(e.templatesNames,(function(t){return s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:t,attrs:{"no-caps":"",to:{name:"CreateSection",params:{templateName:t}}}},[s("q-item-section",[s("q-item-label",[e._v(e._s(e.$t("SectionsEditor."+t+".name")))])],1)],1)})),1)],1)],1),e.sections?s("div",{staticClass:"sections-admin__sections"},e._l(e.sections,(function(t){return s("div",[s("q-icon",{staticClass:"q-mr-sm",attrs:{name:e.$iconsSet.SectionsAdmin.section,color:"grey-6"}}),e._v("\n\t\t\t"+e._s(t.name)+"\n\t\t\t"),s("q-btn",{staticClass:"sections-admin__btn-edit q-ml-sm",attrs:{color:"info",dense:"",size:"10px",flat:"",icon:e.$iconsSet.SectionsAdmin.edit,to:{name:"EditSection",params:{name:t.name}}}}),s("q-btn",{staticClass:"sections-admin__to",attrs:{color:"info",dense:"",size:"10px",flat:"",icon:e.$iconsSet.SectionsAdmin.goTo,to:"/"+t.name.toLowerCase()}}),s("span",{staticClass:"q-ml-lg text-grey-7"},[e._v("["+e._s(t.type)+"]")])],1)})),0):s("LoaderWait")],1)},n=[],a=s("e856"),o={name:"SectionsAdmin",mixins:[a["Page"]],data(){return{sections:null}},computed:{breadcrumbsCategory(){return this.$getBreadcrumbs("Admin")},templatesNames(){const e=Object.values(this.$store.state.sections.sectionsTypes).map((e=>e.name));return e}},methods:{loadData(){this.$request(this.$AdminApi.SectionsAdmin.GetAllSections).then((e=>{this.sections=e.data}))}},created(){this.title=this.$tl("title"),this.loadData()}},l=o,c=(s("07aa"),s("2877")),r=s("f20b"),d=s("1c1c"),m=s("66e5"),u=s("4074"),p=s("0170"),h=s("0016"),f=s("9c40"),v=s("7f67"),b=s("eebe"),g=s.n(b),$=Object(c["a"])(l,i,n,!1,null,null,null);t["a"]=$.exports;g()($,"components",{QBtnDropdown:r["a"],QList:d["a"],QItem:m["a"],QItemSection:u["a"],QItemLabel:p["a"],QIcon:h["a"],QBtn:f["a"]}),g()($,"directives",{ClosePopup:v["a"]})}}]);